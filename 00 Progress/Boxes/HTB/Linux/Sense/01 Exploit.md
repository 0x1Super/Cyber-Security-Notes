https://www.proteansec.com/linux/pfsense-vulnerabilities-part-2-command-injection/
in this blog there is 3 vulnerabilities and in our enum phase we found that there is a txt file which said that they fixed 2 of the 3 vuln which probably means one of this 3 vulns works   
and the one working is Command Injection in status_rrd_graph_img.php
from status
![[Pasted image 20211004220959.png]]
we found the png the blog was talking about ![[Pasted image 20211004221035.png]]
clicking view image 
![[Pasted image 20211004221111.png]]
opening burp

following the blog we managed to get command execution 
![[Pasted image 20211004220725.png]]
![[Pasted image 20211004221326.png]]

when we use / we get no output so probably is a bad char ![[Pasted image 20211004221510.png]]
so we can usue ${HOME} as a / 
after testing out stuff we can now use netcat to run our reverse shell
 [[Reverse Shells]]
 #userflag 8721327cc232073b40d27d9c17e7348b
 #rootflag d08c32a5d4f8c8b10e76eb51a69f1a86